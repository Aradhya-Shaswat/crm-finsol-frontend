import{b8 as k,b9 as q,a as l,aV as C,aU as t}from"./index-BpW8e4D6.js";import{P as E}from"./index-GN6cFBMB.js";import{Q as L,ac as b,V as I,L as w,a9 as B,ag as N}from"./IdurarOs-CzPiZsy4.js";import{s as R,j as H}from"./ErpApp-Ox7LMLtJ.js";import{e as S}from"./actions-Bpk_XOR4.js";import{g as Q}from"./selectors-C4bJO8cF.js";import{c as r}from"./calculate-Bl1nHP9U.js";import{s as T}from"./index-KrFx5yLV.js";import{T as U}from"./index-DeHx2gjr.js";import{C as _}from"./CloseCircleOutlined-CNYDMl4f.js";import{A as z,a as G}from"./ArrowRightOutlined-muWJYQQT.js";import{P as J}from"./PlusOutlined-BspBsbtv.js";function K({form:u}){const f=L(),o=()=>{u.submit()};return t.jsx(w,{onClick:o,type:"primary",icon:t.jsx(J,{}),children:f("Save")})}function nt({config:u,CreateForm:f}){const o=L(),n=k(),m=q();l.useEffect(()=>{n(R.list({entity:"setting"})),n(H.list())},[]);let{entity:i}=u;const{isLoading:v,isSuccess:h,result:A}=C(Q),[p]=b.useForm(),[D,j]=l.useState(0),[F,y]=l.useState(0),O=(s,c)=>{const a=c.items;let d=0,g=0;a&&(a.map(e=>{if(e){if(e.offerPrice&&e.quantity){let x=r.multiply(e.quantity,e.offerPrice);g=r.add(g,x)}if(e.quantity&&e.price){let x=r.multiply(e.quantity,e.price);d=r.add(d,x)}}}),j(d),y(g))};l.useEffect(()=>(h&&(p.resetFields(),n(S.resetAction({actionType:"create"})),j(0),y(0),m(`/${i.toLowerCase()}/read/${A._id}`)),()=>{}),[h]);const P=s=>{if(console.log("ðŸš€ ~ onSubmit ~ fieldsValue:",s),s&&s.items){let c=[...s.items];c.map(a=>{a.total=r.multiply(a.quantity,a.price)}),s={...s,items:c}}n(S.create({entity:i,jsonData:s}))},$=C(I);return t.jsxs(t.Fragment,{children:[t.jsx(E,{onBack:()=>{m(`/${i.toLowerCase()}`)},backIcon:$==="rtl"?t.jsx(z,{}):t.jsx(G,{}),title:o("New"),ghost:!1,tags:t.jsx(U,{children:o("Draft")}),extra:[t.jsx(w,{onClick:()=>m(`/${i.toLowerCase()}`),icon:t.jsx(_,{}),children:o("Cancel")},`${T.generate()}`),t.jsx(K,{form:p},`${T.generate()}`)],style:{padding:"20px 0px"}}),t.jsx(B,{dashed:!0}),t.jsx(N,{isLoading:v,children:t.jsx(b,{form:p,layout:"vertical",onFinish:P,onValuesChange:O,children:t.jsx(f,{subTotal:D,offerTotal:F})})})]})}export{nt as C};
